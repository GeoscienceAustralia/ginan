# Sets metadata files used for Ginan processing
# Warning: Station side metadata is missing from this file, set it as extra yaml inputs (for rovers), or include a station SINEX file

inputs:

    inputs_root: products/

    snx_files:      [ tables/igs_satellite_metadata_2203_plus.snx,
                      tables/sat_yaw_bias_rate.snx,
                      tables/qzss_yaw_modes.snx,
                      tables/bds_yaw_modes.snx                      ]
    atx_files:      [ M20.ATX                           ]

    #egm_files:      [ tables/EGM2008.gfc                ]
    #planetary_ephemeris_files:      [ tables/DE436.1950.2050            ]
    #igrf_files:     [ tables/igrf13coeffs.txt                  ]
    tides:
        #ocean_tide_potential_files:     [ tables/fes2014b_Cnm-Snm.dat       ]
        #ocean_tide_loading_blq_files:  [ OLOAD_GO.BLQ                      ]
    troposphere:
        gpt2grid_files:  [gpt_25.grd]
        # vmf_files:   [ "grid5/*.H00","grid5/*.H06","grid5/*.H12","grid5/*.H18" ]
        # orography_files:  orography_ell_5x5

    #erp_files:  [ IGS1R03SNX_20191950000_07D_01D_ERP.ERP        ]
    satellite_data:
        # nav_files: [ brdm1990.19p                               ]
        #clk_files: [ IGS2R03FIN_20191990000_01D_30S_CLK.CLK     ]
        #bsx_files: [ IGS2R03FIN_20191990000_01D_01D_OSB.BIA     ]
        #sp3_files: [ IGS2R03FIN_20191990000_01D_05M_ORB.SP3, /home/driver/Desktop/GAG0EXPRAP_20232400000_01D_15M_ORB.SP3   ]
        #obx_files: [/home/driver/Desktop/GAG0EXPRAP_20232400000_01D_05M_ATT.OBX]
    gnss_observations:
        gnss_observations_root: ../data/
        rtcm_inputs:
            #- "Val*.rtcm3"
        rnx_inputs:
            #- "ALIC00AUS_R_20191990000_01D_30S_MO.rnx"
            #- "COCO00AUS_R_20191990000_01D_30S_MO.rnx"
            #- "LHAZ00CHN_R_20191990000_01D_30S_MO.rnx"
            #- "KZN200RUS_S_20191990000_01D_30S_MO.rnx"
        ubx_inputs:
            - ~/Downloads/20231212-000117-ginan-02-f9r.ubx

outputs:

    outputs_root:         outputs/<CONFIG>/
    trace:
        level:                      2
        output_receivers:            true
        output_network:             true
        receiver_filename:           <RECEIVER>_<YYYY><DDD><HH>.TRACE
        network_filename:           <RECEIVER>_<YYYY><DDD><HH>.TRACE
        output_residuals:           true
        output_residual_chain:      true
        output_config:              true

    metadata:
        config_description:     "ex201"

    orbex:
        output: true
        attitude_sources: [nominal]
    gpx:
        output:                     true
        filename:                   <RECEIVER><YYYY><DDD><HH>_<CONFIG>.GPX

processing_options:
    process_modes:
        ppp:                 true
    epoch_control:
        max_epochs:         360
        epoch_interval:             30
        wait_next_epoch:            3600
    ppp_filter:
        ionospheric_components:
            common_ionosphere: true
            corr_mode: IONO_FREE_LINEAR_COMBO
            use_if_combo: true
        outlier_screening:
            prefit:
                max_iterations:      5
            postfit:
                max_iterations:      5
        chunking:
            #enable:                     true
        rts:
            enable:         true

    gnss_general:
        rec_reference_system:           GPS
        sys_options:
            gps:
                process:                true
                reject_eclipse:         false
                zero_receiver_dcb:      true
                code_priorities:        [ L1C, L2W ]
            gal:
                process:                true
                reject_eclipse:         false
                zero_receiver_dcb:      true
                code_priorities:        [ L1C, L5Q, L1X, L5X ]
    model_error_handling:
        meas_deweighting:
            deweight_factor:            1000
        state_deweighting:
            deweight_factor:            1000
        ambiguities:
            outage_reset_limit:         5
            phase_reject_limit:         2

mongo:
    enable:                     primary
    output_components:          primary
    output_states:              primary
    output_measurements:        primary
    output_test_stats:          primary
    delete_history:             primary

satellite_options:
    global:
        models:
            code_bias:
                undefined_sigma:    20
            attitude:
                sources: [model]
    E05: { exclude: true }
    E06: { exclude: true }
    E10: { exclude: true }
    E16: { exclude: true }
    E17: { exclude: true }
    E23: { exclude: true }
    E28: { exclude: true }
    E29: { exclude: true }
    E32: { exclude: true }
    E34: { exclude: true }
    E35: { exclude: true }

receiver_options:
    global:
        elevation_mask:                 10  #degrees
        code_sigma:         0.3
        phase_sigma:         0.003
        models:
            attitude:
                sources: [model]
# Set four rinex files as input to rover processing
    ALIC:
        receiver_type:  "LEICA GR25"                 # (string)
        antenna_type:   "LEIAR25.R3      NONE"       # (string)
        models:
            eccentricity:
                offset:   [0.0000,   0.0000,   0.0015] # [floats]
        apriori_position:   [-4052052.7254, 4212835.9872,-2545104.6139] # [floats]
    COCO:
        receiver_type:  "SEPT POLARXS"               # (string)
        antenna_type:   "AOAD/M_T        NONE"       # (string)
        models:
            eccentricity:
                offset:   [0.0000,   0.0000,   0.0000] # [floats]
        apriori_position:   [-741951.0562, 6190961.7216, -1337767.4032] # [floats]
    LHAZ:
        receiver_type:  "LEICA GR25"                 # (string)
        antenna_type:   "LEIAR25.R4      LEIT"       # (string)
        models:
            eccentricity:
                offset:   [0.0000,   0.0000,   0.1330] # [floats]
        apriori_position:   [-106942.1180, 5549269.7735, 3139215.2108] # [floats]
    KZN2:
        receiver_type:  "TRIMBLE NETR9"              # (string)
        antenna_type:   "TRM59800.00     SCIS"       # (string)
        models:
            eccentricity:
                offset:   [0.0000,   0.0000,   0.0750] # [floats]
        apriori_position:   [ 2352345.8201, 2717466.5769, 5251459.2269] # [floats]


estimation_parameters:
    receivers:
        global:
            pos:
                estimated:          [true]
                sigma:              [100]
                process_noise:         [100]
            clock:
                estimated:          [true]
                sigma:              [1000]
                process_noise:         [100]
            #pcv:
                #estimated:          [true]
                #sigma:              [0.1]
            ambiguities:
                estimated:          [true]
                sigma:              [1000]
                process_noise:         [0]
            trop:
                estimated:          [true]
                sigma:              [0.3]
                process_noise:         [0.0001]
            trop_grads:
                estimated:          [true]
                sigma:              [0.03]
                process_noise:         [1.0E-6]
            ion_stec:
                estimated:          [true]
                sigma:              [200]
                process_noise:         [10]
            code_bias:
                estimated:          [true]
                sigma:              [20]
                process_noise:         [0]
            phase_bias:
                estimated:          [true]
                sigma:              [10]
                process_noise:         [0]

debug:
    explain_measurements:       true
    #instrument:                 true
    #instrument_once_per_epoch:  true
